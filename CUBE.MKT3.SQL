   -----------CUBE.MKT3
    SELECT
    O.OUTLET_PBI
  , P.NAME CABANG
  , A.TGL
  , TO_CHAR(A.TGL,'YYYY') TAHUN
  , TO_CHAR(A.TGL,'MM')   MONTH
  , R.NAME                REGION
  , A.REFEREE_ID
  , C.NAME                REFEREE
  , C.COMPANY_SUBGROUP_ID SUBGROUP_ID
  , CS.NAME               SUBGROUP
  , C.COMPANY_GROUP_ID    GROUP_ID
  , CG.NAME               COMPANY_GROUP
  , CC.CC_GROUP_ID
  , CCG.NAME CONTRACT_GROUP
  , CC.CT_GROUP_ID
  , CCT.NAME CONTRACT_TYPE
  , A.DOCTOR_ID
  , DECODE(D.NAME, 'APD-CS','APD-CS', '-','APD-CS', D.NAME)                                          DOCTOR
  , DECODE(A.DOCTOR_ID,'00000','N/A',D.SPECIALTY)                                                    SPECIALTY
  , DECODE(A.DOCTOR_ID,'00000','N/A',D.ABBR)                                                         SPECIALTY_ABBR
  , DECODE(A.DOCTOR_ID,'00000','N/A',d.specialty_group)                                                         SPECIALTY_GROUP
  , DECODE(CCG.CC_GROUP_ID,'10', DECODE(D.NAME, 'APD-CS','01', '-','01', '02'),CCG.CC_GROUP_ID)      SEGMEN_ID
  , DECODE(CCG.CC_GROUP_ID,'10', DECODE(D.NAME, 'APD-CS','APD-CS', '-','APD-CS', 'APD'),CCG.NAME)    SEGMEN
  , DECODE(CCG.CC_GROUP_ID,'10', DECODE(D.NAME, 'APD-CS','APD-CS', '-','APD-CS', 'APD'),CCG.SEGMENT) SEGMENTASI_MKT
  , A.J_PSN - A.R_PSN                                                                                VISIT_PATIENT
  , A.J_BRUTO
  , A.J_DISKON
  , A.J_NETTO
  , A.R_BRUTO
  , A.R_DISKON
  , A.R_NETTO
  , A.J_NETTO-R_NETTO TOTAL
  , A.OUTLET_ID
  , MO.NAME OUTLET
  , DECODE(TO_CHAR(SYSDATE,'YYYY'),TO_CHAR(A.TGL,'YYYY'), A.J_NETTO-R_NETTO, 0) TAHUN_0
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-1,TO_CHAR(A.TGL,'YYYY'), A.J_NETTO-R_NETTO, 0) TAHUN_1
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-2,TO_CHAR(A.TGL,'YYYY'), A.J_NETTO-R_NETTO, 0) TAHUN_2
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-3,TO_CHAR(A.TGL,'YYYY'), A.J_NETTO-R_NETTO, 0) TAHUN_3
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-4,TO_CHAR(A.TGL,'YYYY'), A.J_NETTO-R_NETTO, 0) TAHUN_4
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-5,TO_CHAR(A.TGL,'YYYY'), A.J_NETTO-R_NETTO, 0) TAHUN_5
	, DECODE(TO_CHAR(SYSDATE,'YYYY'),TO_CHAR(A.TGL,'YYYY'), A.J_PSN - A.R_PSN, 0) VISIT_TAHUN_0
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-1,TO_CHAR(A.TGL,'YYYY'), A.J_PSN - A.R_PSN, 0) VISIT_TAHUN_1
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-2,TO_CHAR(A.TGL,'YYYY'), A.J_PSN - A.R_PSN, 0) VISIT_TAHUN_2
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-3,TO_CHAR(A.TGL,'YYYY'), A.J_PSN - A.R_PSN, 0) VISIT_TAHUN_3
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-4,TO_CHAR(A.TGL,'YYYY'), A.J_PSN - A.R_PSN, 0) VISIT_TAHUN_4
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-5,TO_CHAR(A.TGL,'YYYY'), A.J_PSN - A.R_PSN, 0) VISIT_TAHUN_5
FROM                                           
    SALES3                 A
  , OUTLET_PBI_DET         O
  , OUTLET_PBI             P
  , METADDT.REGION_ERP     R
  , COMPANY                C
  , COMPANY_SUBGROUP       CS
  , COMPANY_GROUP          CG
  , COMPANY_CONTRACT       CC
  , COMPANY_CONTRACT_GROUP CCG
  , COMPANY_CONTRACT_TYPE  CCT
  , DOCTOR                 D
  , METADDT.OUTLET         MO
WHERE
    A.OUTLET_ID               = O.OUTLET_ID(+)
    AND O.OUTLET_PBI          = P.OUTLET_PBI(+)
    AND P.REGION_ID           = R.PBI_REGION_ID(+)
    AND A.REFEREE_ID          = C.COMPANY_ID(+)
    AND C.COMPANY_SUBGROUP_ID = CS.COMPANY_SUBGROUP_ID(+)
    AND C.COMPANY_GROUP_ID    = CG.COMPANY_GROUP_ID(+)
    AND A.REFEREE_ID          = CC.COMPANY_ID(+)
    AND CC.CC_GROUP_ID        = CCG.CC_GROUP_ID(+)
    AND CC.CT_GROUP_ID        = CCT.CT_GROUP_ID(+)
    AND A.DOCTOR_ID           = D.DOCTOR_ID(+)
    AND A.OUTLET_ID           = MO.OUTLET_ID(+)
    AND A.TGL                >= '1 JAN 2017';


TESTING DUMMY

 SELECT
    O.OUTLET_PBI
  , P.NAME CABANG
  , A.TGL
  , TO_CHAR(A.TGL,'YYYY') TAHUN
  , TO_CHAR(A.TGL,'MM')   MONTH
  , R.NAME                REGION
  , A.REFEREE_ID
  , C.NAME                REFEREE
  , C.COMPANY_SUBGROUP_ID SUBGROUP_ID
  , CS.NAME               SUBGROUP
  , C.COMPANY_GROUP_ID    GROUP_ID
  , CG.NAME               COMPANY_GROUP
  , CC.CC_GROUP_ID
  , CCG.NAME CONTRACT_GROUP
  , CC.CT_GROUP_ID
  , CCT.NAME CONTRACT_TYPE
  , A.DOCTOR_ID
  , DECODE(D.NAME, 'APD-CS','APD-CS', '-','APD-CS', D.NAME)                                          DOCTOR
  , DECODE(A.DOCTOR_ID,'00000','N/A',D.SPECIALTY_ID)                                                    SPECIALTY
  , DECODE(A.DOCTOR_ID,'00000','N/A',D.ABBR)                                                         SPECIALTY_ABBR
  , DECODE(A.DOCTOR_ID,'00000','N/A',d.specialty_group_ID)                                                         SPECIALTY_GROUP
  , DECODE(CCG.CC_GROUP_ID,'10', DECODE(D.NAME, 'APD-CS','01', '-','01', '02'),CCG.CC_GROUP_ID)      SEGMEN_ID
  , DECODE(CCG.CC_GROUP_ID,'10', DECODE(D.NAME, 'APD-CS','APD-CS', '-','APD-CS', 'APD'),CCG.NAME)    SEGMEN
  , DECODE(CCG.CC_GROUP_ID,'10', DECODE(D.NAME, 'APD-CS','APD-CS', '-','APD-CS', 'APD'),CCG.SEGMENT) SEGMENTASI_MKT
  , A.J_PSN - A.R_PSN                                                                                VISIT_PATIENT
  , A.J_BRUTO
  , A.J_DISKON
  , A.J_NETTO
  , A.R_BRUTO
  , A.R_DISKON
  , A.R_NETTO
  , A.J_NETTO-R_NETTO TOTAL
  , A.OUTLET_ID
  , MO.NAME OUTLET
  , DECODE(TO_CHAR(SYSDATE,'YYYY'),TO_CHAR(A.TGL,'YYYY'), A.J_NETTO-R_NETTO, 0) TAHUN_0
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-1,TO_CHAR(A.TGL,'YYYY'), A.J_NETTO-R_NETTO, 0) TAHUN_1
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-2,TO_CHAR(A.TGL,'YYYY'), A.J_NETTO-R_NETTO, 0) TAHUN_2
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-3,TO_CHAR(A.TGL,'YYYY'), A.J_NETTO-R_NETTO, 0) TAHUN_3
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-4,TO_CHAR(A.TGL,'YYYY'), A.J_NETTO-R_NETTO, 0) TAHUN_4
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-5,TO_CHAR(A.TGL,'YYYY'), A.J_NETTO-R_NETTO, 0) TAHUN_5
	, DECODE(TO_CHAR(SYSDATE,'YYYY'),TO_CHAR(A.TGL,'YYYY'), A.J_PSN - A.R_PSN, 0) VISIT_TAHUN_0
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-1,TO_CHAR(A.TGL,'YYYY'), A.J_PSN - A.R_PSN, 0) VISIT_TAHUN_1
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-2,TO_CHAR(A.TGL,'YYYY'), A.J_PSN - A.R_PSN, 0) VISIT_TAHUN_2
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-3,TO_CHAR(A.TGL,'YYYY'), A.J_PSN - A.R_PSN, 0) VISIT_TAHUN_3
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-4,TO_CHAR(A.TGL,'YYYY'), A.J_PSN - A.R_PSN, 0) VISIT_TAHUN_4
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-5,TO_CHAR(A.TGL,'YYYY'), A.J_PSN - A.R_PSN, 0) VISIT_TAHUN_5
FROM                                           
    RPT_MARKETING_SALES_3  A
  , OUTLET_PBI_DET         O
  , OUTLET_PBI             P
  , TBL_REGION_ERP         R
  , COMPANY                C
  , COMPANY_SUBGROUP       CS
  , COMPANY_GROUP          CG
  , COMPANY_CONTRACT       CC
  , TBL_COMPANY_CONTRACT_GROUP CCG
  , COMPANY_CONTRACT_TYPE  CCT
  , DOCTOR_ARIS    D
  , OUTLET         MO
WHERE
    A.OUTLET_ID               = O.OUTLET_ID(+)
    AND O.OUTLET_PBI          = P.OUTLET_PBI(+)
    AND P.REGION_ID           = R.PBI_REGION_ID(+)
    AND A.REFEREE_ID          = C.COMPANY_ID(+)
    AND C.COMPANY_SUBGROUP_ID = CS.COMPANY_SUBGROUP_ID(+)
    AND C.COMPANY_GROUP_ID    = CG.COMPANY_GROUP_ID(+)
    AND A.REFEREE_ID          = CC.COMPANY_ID(+)
    AND CC.CC_GROUP_ID        = CCG.CC_GROUP_ID(+)
    AND CC.CT_GROUP_ID        = CCT.CT_GROUP_ID(+)
    AND A.DOCTOR_ID           = D.DOCTOR_ID(+)
    AND A.OUTLET_ID           = MO.OUTLET_ID(+)
    AND A.TGL                >= '1 JAN 2017';
